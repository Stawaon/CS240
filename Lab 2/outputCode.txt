using System;
using System.Collections.Generic;
using System.Threading;

private void PlayerTurn(int playerRank) {
    CheckForBooks(playerHand, playerBooks);
    bool opponentHasCard = false;
    // Iterate through opponent's hand to check for card
    var opponentIterator = opponentHand.GetCards().GetEnumerator();
    while (opponentIterator.MoveNext()) {
        Card card = opponentIterator.Current;
        if (card.GetRank() == playerRank) {
            opponentHasCard = true;
            opponentIterator.Dispose();
            opponentHand.RemoveCard(card);
            playerHand.AddCard(card);
        }
    }

    // Pause for a second to simulate thinking
    Thread.Sleep(1000);

    // Check opponent's hand for card. If not found, player draws a card from the deck
    if (opponentHasCard) {
        Console.WriteLine("Opponent has the card(s) you asked for!");
    } else {
        Console.WriteLine("Go fish!");
        if (deck.GetCards().Count > 0) {
            playerHand.AddCard(deck.GetCards()[0]);
            deck.RemoveCard(deck.GetCards()[0]);
            Thread.Sleep(500);
            Console.WriteLine("You drew a " + playerHand.GetCards()[playerHand.GetCards().Count - 1].GetRank());
        }
        playerTurn = false;
    }

    CheckForBooks(playerHand, playerBooks);
}

// Method for opponent's turn
private void OpponentTurn() {
    CheckForBooks(opponentHand, opponentBooks);
    Console.WriteLine("Opponent's turn!");
    Console.Write("Opponent's books: ");
    DisplayBooks(opponentBooks);
    bool playerHasCard = false;

    // Generate a random card, of which the opponent possesses to ask the player for
    Random rand = new Random();
    int opponentRank;
    if (opponentHand.GetCards().Count != 0 && playerHand.GetCards().Count != 0) {
        do {
            int randomIndex = rand.Next(opponentHand.GetCards().Count);
            opponentRank = opponentHand.GetCards()[randomIndex].GetRank();
        } while (opponentRank == lastOpponentRank);
        lastOpponentRank = opponentRank;
        Console.WriteLine("Opponent asks for a: " + opponentRank);

        var playerIterator = playerHand.GetCards().GetEnumerator();
        while (playerIterator.MoveNext()) {
            Card card = playerIterator.Current;
            if (card.GetRank() == opponentRank) {
                playerHasCard = true;
                playerIterator.Dispose();
                playerHand.RemoveCard(card);
                opponentHand.AddCard(card);
            }
        }
    } else {
        Console.WriteLine("Opponent's hand is empty! Opponent draws a card from the deck.");
    }

    // Pause for a second to simulate thinking
    Thread.Sleep(1000);

    // Check player's hand for card. If not found, opponent draws a card from the deck
    if (playerHasCard) {
        Console.WriteLine("You had the card(s) your opponent asked for!");
    } else {
        Console.WriteLine("Opponent Goes Fish!");
        if (deck.GetCards().Count > 0) {
            opponentHand.AddCard(deck.GetCards()[0]);
            deck.RemoveCard(deck.GetCards()[0]);
        }
        playerTurn = true;
    }
    CheckForBooks(opponentHand, opponentBooks);
}

